---
title: "Statistical Inference"
subtitle: "CRM Lecture 3"
author: "Charles Lanfear"
date: "25 Oct 2022<br>Updated: `r gsub(' 0', ' ', format(Sys.Date(), format='%d %b %Y'))`"
output:
  xaringan::moon_reader:
    css: "../assets/cam-css.css"
    lib_dir: libs
    nature:
      highlightStyle: tomorrow-night-bright
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "../assets/cam_macros.js"
      titleSlideClass: ["center","top"]
---

# Today
---

# Causality with Correlation

No correlation between speed of a car and how far gas pedal is pushed when going up and down hills
---

# Establishing Causation

Let's say we want to know if clearing a vacant lot reduces crime

--

&zwj;Problem: We only observe *one outcome* per unit—if we clear a lot, we don't see what happens when we don't clear it.<sup>1</sup>

.footnote[[1] This is often called the "fundamental problem of causal inference"]

--

We call the unobserved outcome a **counterfactual**—it is counter to the fact of what actually happened

-

Causal effects are differences between reality and unobserved counterfactuals

--

The goal of causal research is figuring out how to accurate estimate these "missing" values we cannot observe--the counterfactuals

---
# Causality (in Brief)

---
# Data Generating PRocesses

---
# Causal Effects


---
# Counterfactuals

---

# Correlations Require Variation

---

# Selection on Dependent Variable



---

# Nonlinearity


---

# More Complex Lines

So far we've just fit a simple straight line using one variable predicting another

--

We can introduce multiple explanatory variables

```{r}
lm(`Crime Rate` ~ Area + `Pop Density`, data = communities) %>% 
  broom::tidy() %>%
  select(Term = term, Estimate = estimate) %>%
  mutate(Term = case_when(
    Term == "AreaUrban" ~ "Urban",
    TRUE ~ Term
  ),
  Estimate = round(Estimate, 2)) %>%
  arrange(desc(Term)) %>%
  pander::pander()

```


The interpretation stay


---

# Curves

```{r}
form <- y ~ x + I(x^2)
communities %>%
  ggplot(aes(x = `Pop Density`, y = `Crime Rate`)) + 
  geom_point(alpha = 0.5) +
  xlab("Population Density") +
  stat_poly_line(formula = form, se = FALSE) +
  stat_poly_eq(formula = form, mapping = use_label("eq"), eq.x.rhs = "PopDensity", eq.with.lhs= "CrimeRate~`=`~") +
  theme_minimal(base_size = 16)
```

---

# More Variables

&nbsp;

```{r}
lm_two_covars <- lm(crime_rate ~ control + pop_density, data = communities_orig)
control_seq   <- seq(-3.5, 3.5, by = .5)
pop_seq       <- seq(0, 30, by = 5)

grid_wide <- 
  expand_grid(control = control_seq, pop_density = pop_seq) %>% 
  mutate(pred_lm = predict(lm_two_covars, newdata = data.frame(control, pop_density))) %>% 
  pivot_wider(names_from = control, values_from = pred_lm) %>% 
  select(-1) %>%  # kick the name's column out
  as.matrix()
p1 <- plot_ly(
        x = communities_orig$control,
        y = communities_orig$pop_density,
        z = communities_orig$crime_rate,
        type = "scatter3d",
        color = I("black"),
        size = 0.25,
        alpha = 1,
        alpha_stroke = 1) 
p1 <-  add_trace(p1,
            z = grid_wide,
                x = control_seq,
                y = pop_seq,
                type = "surface",
            alpha = 1)
p1
```


---
class: inverse
# Measuring Bias in Policing

### An example from Knox, Lowe, & Mummolo. 2020. "Administrative Records Mask Racially Biased Policing"

---
# Use of Force


&zwj;Question: Do police use more force against black civilians?

???

Note the effect here is really perceptions of race by police, not race itself.

--

Imagine you have sample of police encounters identical except for race.

*But* suppose bias leads police to:
1. Stop white civilians only for serious crimes
2. Stop black civilians with or without crime

--

Then, discard data on anyone police observed but *did not stop*.
+ You are now comparing use of force against white people committing serious crime to black ones committing no crime
+ If use of force were the same, *we'd have a serious problem*

--

*This is what police data actually show!*
* We only see the stopped people.
* There is no comparison group.


---
# What We Want

.image-threequarters[
![](img/bias_1.svg)
]

&zwj;Question: How does race impact use of force?

---
# The Problem

.image-threequarters[
![](img/bias_2.svg)
]

Problems

* Race impacts likelihood of stop
* Race also impacts use of force
* Can't control for stops *because we never see unstopped people*


---
# It Gets Worse

.image-threequarters[
![](img/bias_complete.svg)
]

More problems

* Racial composition varies by neighborhood
* Police deployments and strategy vary by neighborhood
* Suspicion predicts both stops and use of force--and can't be observed

???

Some novel papers have gotten at these before, but it is incredibly challenging.

One example is comparing drivers stopped when sun is up to when sun is down--when police can't see race.

---
# Consequences

* Detecting bias in the decision to stop is difficult

   + Hit rate tests

???

Hit rate tests estimate differences between likelihood of, for example, a frisk resulting in a found gun by race of suspect

If guns found less often on black suspects, indicates bias

Not perfect because need to adjust for fact that black folks live in different places and police strategies differ

One important thing is using more objective outcome: arrests might be biased, finding a weapon can't be biased unless they planting.

--

* If any stop bias exists, it is difficult to measure bias in...

   + Arrests
   + Use of force
   + Frisks
   + Shootings

???

This is an issue many if not most researchers working in this area don't fully grasp

Vast majority of work in area does not account properly for this

--

* Raw numbers can easily show *opposite patterns* from underlying reality.

* Studies showing no bias--or anti-white bias--get *lots* of media, social media, and political traction.

???

Fryer paper making the rounds back last summer showed this, but was just wrong.

---

# Causality and QUalitative Data

Sometimes quantitative data is not up to the task of identifying an effect of interest


McElreath gender, citations, NAS, quality DAG
